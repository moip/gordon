# Gordon

We all know that build application packages is a pain. A lot of pain.

Of course, [fpm](https://github.com/jordansissel/fpm) is a awesome tool to abstract package building for a lot of Operational Systems. Period.

Of course, [fpm-cookery](https://github.com/bernd/fpm-cookery) is another great tool to approach building as a simple recipe.

But, unfortunately, create recipes for each application can be boring and repetitive. You need to create init files (inittab, systemd, etc) for each project
and, if a webserver changes (example: from Thin to Unicorn) you need to change script again, again and again.

And when you are in front with a web application that breaks Nginx or Apache conventions? Do you remember that feel, bro?

Gordon is a try to automagically create init files using Foreman and build artifacts using FPM. Make developers free to develop, while you take apps under a minimal control.

## How it works?

Gordon have a lot of restrictions:

* Web Servers: Nginx or Apache (Tomcat soon);
* Init scripts: all generated by Foreman;
* Apps supported: at this time, Ruby. Java soon and others too.

## Installation

Add this line to your application's Gemfile:

    gem 'gordon'

And then execute:

    $ bundle

Or install it yourself as:

    $ gem install gordon

## Usage

A simple example to build a Ruby Web App that runs Nginx and uses Systemd as init process:

    $ ruby -S gordon                    \
      --app-type        ruby_web_app    \
      --app-name        $APP_NAME       \
      --app-desc        $APP_DESC       \
      --app-repo        $APP_REPO       \
      --app-version     $APP_VERSION    \
      --package-type    rpm             \
      --package-dir     .               \
      --source-dir      .               \
      --build-dir       /tmp            \
      --skeleton-type   nginx           \
      --init-type       systemd         \
      --init-build-dir  /tmp/systemd

It will generate a RPM package with the following structure:

* /usr/share/nginx/html/<all_app_stuff>
* /usr/lib/systemd/system/<app_name>/<all_systemd_stuff>

Sounds good?

## Why you not use Omnibus or Heroku buildpacks?

Because I want to create a tool that can be used as a transition step.

## Why you use fpm-cookery templates instead of fpm?

Because I not found a trivial way to use fpm when you need to package a application under different directories (Apache2 and Systemd per example). If you show to me, I will think to abolish templates.

## TODO

* Very unstable, need to fix it
* Validate outputs
* Fix annoying --package-dir OptionParser::InvalidOption error
* Add a way to map package dependencies
* Adapt to use Debian and other OS conventions for Nginx and Apache
* Create a better way to handle env vars than injecting a lot of global variables in fpm-cookery ruby-web-app template
* Tests

## Contributing

1. Fork it
2. Create your feature branch (`git checkout -b my-new-feature`)
3. Commit your changes (`git commit -am 'Add some feature'`)
4. Push to the branch (`git push origin my-new-feature`)
5. Create new Pull Request
